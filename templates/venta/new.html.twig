{% extends 'base.html.twig' %}
{% form_theme form 'bootstrap_5_layout.html.twig' %}

{% block title %}SisVentas - Ventas{% endblock %}
{% block bodytitle %}Venta{% endblock %}

{% block body %}
    <script> const ps={{ productos_stock|raw }};</script>

    {% for message in app.flashes('error') %}
        <div class="alert alert-danger">
            {{ message }}
        </div>
    {% endfor %}
    
    {% for message in app.flashes('success') %}
        <div class="alert alert-success">
            {{ message }}
        </div>
    {% endfor %}
    
    {{ form_start(form) }}
    {{ form_row(form.cliente) }}
    {{ form_row(form.Factura) }}
    {{ form_row(form.Fecha) }}
    
    <h3 style="display: inline">Productos</h3>
    <button type="button" class="mx-2 mb-2 btn btn-success btn-sm add_item_link" data-collection-holder-class="detalles"><i class="bi bi-plus-circle"></i> Agregar</button>
    	<table class="table table-striped table-sm">
		<thead>
			<tr>
				<th>Producto</th>
				<th>Cantidad</th>
                                <th></th>
			</tr>
		</thead>
		<tbody class="detalles" data-index="{{ form.detalles|length > 0 ? form.detalles|last.vars.name + 1 : 0 }}"
    data-prototype="{{ '<td><input type="hidden" value="0" class="producto_stock" />'|e('html_attr') }}{{ form_row(form.detalles.vars.prototype.producto)|e('html_attr') }}{{'</td><td>'|e('html_attr') }}{{ form_row(form.detalles.vars.prototype.Cantidad)|e('html_attr') }}</td>">
        
        {% for detalle in form.detalles %}
            <tr>
                <td style="width: 80%"><input type="hidden" value="0" class="producto_stock" />{{ form_row(detalle.producto) }}</td>
                <td style="width: 15%">{{ form_row(detalle.Cantidad) }}</td>
            </tr>
        {% endfor %}
    </tbody>
    </table>
    {{ form_end(form) }}

    <a href="{{ path('app_venta') }}" class="btn btn-secondary">Volver</a>


{% endblock %}
